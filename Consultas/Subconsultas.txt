/*Subconsultas (consultas dentro de outras consultas) e partindo desse conceito tambÃ©m aprendemos sobre as views no SQL.*/

SELECT DISTINCT BAIRRO FROM tabela_de_vendedores;

SELECT * FROM tabela_de_clientes WHERE BAIRRO IN ('Tijuca', 'Jardins', 'Copacabana', 'Santo amaro');

SELECT * FROM tabela_de_clientes WHERE BAIRRO IN (SELECT DISTINCT BAIRRO FROM tabela_de_vendedores);

SELECT X.EMBALAGEM, X.PRECO_MAXIMO FROM (SELECT EMBALAGEM, MAX(PRECO_DE_LISTA) AS PRECO_MAXIMO FROM tabela_de_produtos GROUP BY EMBALAGEM) X WHERE X.PRECO_MAXIMO >= 10;

SELECT CPF, COUNT(*) FROM notas_fiscais WHERE YEAR(DATA_VENDA) = 2016 GROUP BY CPF HAVING COUNT(*) > 2000;
  
SELECT X.CPF, X.CONTADOR FROM (SELECT CPF, COUNT(*) AS CONTADOR FROM notas_fiscais WHERE YEAR(DATA_VENDA) = 2016 GROUP BY CPF) X WHERE X.CONTADOR > 2000;

SELECT EMBALAGEM, MAX(PRECO_DE_LISTA) AS PRECO_MAXIMO FROM tabela_de_produtos GROUP BY EMABALAGEM;

/*exemplo usando view (VW_) */

SELECT X.EMBALAGEM, X.PRECO_MAXIMO FROM VW_MAIORES_EMBALAGENS X WHERE X.PRECO_MAXIMO >=10; 

SELECT A.NOME_DO_PRODUTO, A.EMBALAGEM, A.PRECO_DE_LISTA, X.PRECO_MAXIMO FROM tabela_de_produtos A INNER JOIN VW_MAIORES_EMBALAGENS X ON A.EMBALAGEM = X.EMBALAGEM;